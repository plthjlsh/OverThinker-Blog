---
import { getEntry, render } from "astro:content";

interface Props {
	class?: string;
}

const { class: className = "" } = Astro.props;

// è·å–ç«™ç‚¹é…ç½®ä¿¡æ¯
const siteTitle = import.meta.env.SITE_TITLE || "Overthinker-Blog";
const profileName = "Overthinker";
const bio = "è¿‡åº¦æ€è€ƒè€…ï¼Œæ­£åœ¨å°†å±å±±é›•ç¢æˆè‰ºæœ¯å“çš„è·¯ä¸Š...";

// è·å–å‹é“¾æ•°æ®
let friendsItems = [];
try {
	const friendsPost = await getEntry("spec", "friends");
	if (friendsPost) {
		const { Content } = await render(friendsPost);
		// æ³¨æ„ï¼šè¿™é‡Œçš„æ•°æ®æ˜¯ä» friends.astro é¡µé¢å¤åˆ¶çš„ï¼Œå› ä¸ºåœ¨å½“å‰æ–‡ä»¶ä¸­æ— æ³•ç›´æ¥è®¿é—®è¯¥æ–‡ä»¶çš„å˜é‡
		friendsItems = [
			{
				title: "Astro",
				imgurl: "https://avatars.githubusercontent.com/u/44914786?s=48&v=4",
				desc: "The web framework for content-driven websites. â­ï¸ Star to support our work!",
				siteurl: "https://github.com/withastro/astro",
				tags: ["Framework"],
			},
			{
				title: "N",
				imgurl: "/FriendsAvatar/n.jpg",
				desc: "Nçš„CSDNåšå®¢",
				siteurl: "https://blog.csdn.net/qq_46698164?type=blog",
				tags: ["Brother"],
			},
			{
				title: "OverThinker",
				imgurl: "/FriendsAvatar/K.jpg",
				desc: "Kçš„CSDNåšå®¢",
				siteurl: "https://blog.csdn.net/weixin_46491509?type=blog",
				tags: ["Me"],
			},
			{
				title: "æ¾ªè´°",
				imgurl: "/FriendsAvatar/æ¾ªè´°.jpg",
				desc: "æ¾ªè´°çš„ä¸ªäººåšå®¢",
				siteurl: "https://general.zzh-blog.club/",
				tags: ["Friend"],
			},
			{
				title: "CodeSuc",
				imgurl: "/FriendsAvatar/CodeSuc.jpg",
				desc: "CodeSucçš„CSDNåšå®¢",
				siteurl: "https://blog.csdn.net/weixin_63944437",
				tags: ["Friend"],
			},
		];
	}
} catch (e) {
	console.error("Failed to load friends data:", e);
	friendsItems = [];
}

// è·å–é¡¹ç›®æ•°æ®
const projectsData = [
	{
		id: "OverThinker-blog",
		title: "OverThinker Blog",
		description:
			"åŸºäºAstroæ¡†æ¶å¼€å‘çš„ç°ä»£åŒ–åšå®¢ä¸»é¢˜ï¼Œæ”¯æŒå¤šè¯­è¨€ã€æš—é»‘æ¨¡å¼ã€å“åº”å¼è®¾è®¡ç­‰åŠŸèƒ½ã€‚",
		category: "web",
		techStack: ["Astro", "TypeScript"],
		status: "in-progress",
		startDate: "2025-04-29",
		endDate: "2025-09-10",
		featured: true,
		tags: ["Blog", "Open Source"],
	},
	{
		id: "Multi-user Chat Room",
		title: "å¤šäººèŠå¤©å®¤",
		description: "Spring Webé¡¹ç›®ï¼ŒåŸºäºWebSocketå®ç°çš„å®æ—¶èŠå¤©åº”ç”¨ã€‚",
		category: "web",
		techStack: ["WebSocket", "Spring Web", "MySql"],
		status: "in-progress",
		startDate: "2023-09-01",
		endDate: "2023-12-01",
		featured: true,
		tags: ["Spring Web", "MySql", "èŠå¤©åº”ç”¨"],
	},
	{
		id: "Godotæ¸¸æˆå¼•æ“",
		title: "Godotæ¸¸æˆå¼•æ“",
		description:
			"Godotæ˜¯å¼€æºè·¨å¹³å°æ¸¸æˆå¼•æ“ï¼Œè½»é‡é«˜æ•ˆï¼Œæ”¯æŒ2D/3Då¼€å‘ï¼Œç”¨GDScriptç­‰è¯­è¨€ï¼Œé€‚åˆå„ç±»æ¸¸æˆåˆ¶ä½œã€‚",
		category: "mobile",
		techStack: ["Godot", "GDScript", "Game Engine"],
		status: "planned",
		startDate: "2024-10-13",
		tags: ["Godot", "GDScript", "Game Engine", "å¼€å‘"],
	},
	{
		id: "Java",
		title: "JavaSE",
		description:
			"Javaæ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ï¼Œå…·æœ‰è·¨å¹³å°ç‰¹æ€§ï¼Œé€‚ç”¨äºå¼€å‘ä¼ä¸šçº§åº”ç”¨ã€ç§»åŠ¨åº”ç”¨å’Œå¤§æ•°æ®å¤„ç†ç­‰ã€‚",
		category: "web",
		techStack: ["Java", "JavaSE"],
		status: "completed",
		startDate: "2025-01-01",
		endDate: "2025-06-22",
		tags: ["Java", "JavaSE", "ç¼–ç¨‹è¯­è¨€"],
	},
	{
		id: "æ•°æ®ç»“æ„ä¸ç®—æ³•",
		title: "æ•°æ®ç»“æ„åˆé˜¶",
		description:
			"æ•°æ®ç»“æ„ä¸ç®—æ³•æ˜¯è®¡ç®—æœºç§‘å­¦çš„æ ¸å¿ƒï¼Œæ¶‰åŠæ•°æ®çš„ç»„ç»‡ã€å­˜å‚¨å’Œæ“ä½œæ–¹æ³•ï¼Œæå‡ç¨‹åºæ•ˆç‡å’Œæ€§èƒ½ã€‚",
		category: "web",
		techStack: ["æ•°æ®ç»“æ„", "ç®—æ³•", "Java", "æ’åºç®—æ³•"],
		status: "completed",
		startDate: "2025-04-07",
		endDate: "2025-07-01",
		tags: ["æ•°æ®ç»“æ„", "ç®—æ³•", "æ’åº", "æŸ¥æ‰¾"],
	},
];

// ç¨‹åºå‘˜ç¬‘è¯æ•°æ®
const jokes = [
	"ä¸ºä»€ä¹ˆç¨‹åºå‘˜å–œæ¬¢é»‘æš—æ¨¡å¼ï¼Ÿå› ä¸ºä»–ä»¬ä¸æƒ³çœ‹åˆ°è‡ªå·±çš„é”™è¯¯ï¼",
	"ç¨‹åºå‘˜çš„å¥³æœ‹å‹è¯´ï¼š'ä½ çˆ±æˆ‘è¿˜æ˜¯çˆ±ç”µè„‘ï¼Ÿ' ç¨‹åºå‘˜å›ç­”ï¼š'æˆ‘å¯¹ç”µè„‘æ²¡æœ‰æ„Ÿæƒ…ã€‚'",
	"ä¸ºä»€ä¹ˆç¨‹åºå‘˜æ€»æ˜¯åˆ†ä¸æ¸…ä¸‡åœ£èŠ‚å’Œåœ£è¯èŠ‚ï¼Ÿå› ä¸º Oct 31 == Dec 25ï¼",
	"æœ‰ä¸€ä¸ªç¨‹åºå‘˜å»ä¹°èœï¼Œè€å©†å¯¹ä»–è¯´ï¼š'å»ç§°ä¸€æ–¤è‹¹æœï¼Œå¦‚æœæœ‰é¸¡è›‹çš„è¯ï¼Œä¹°åä¸ªã€‚' ç¨‹åºå‘˜å›æ¥ä¹°äº†åæ–¤è‹¹æœã€‚è€å©†é—®ï¼š'ä¸ºä»€ä¹ˆä¹°åæ–¤è‹¹æœï¼Ÿ' ç¨‹åºå‘˜ç­”ï¼š'å› ä¸ºæœ‰é¸¡è›‹å•Šã€‚'",
	"ç¨‹åºå‘˜çš„ç”Ÿæ´»ï¼šä¸Šç­å†™ä»£ç ï¼Œä¸‹ç­è°ƒè¯•ä»£ç ï¼Œæ™šä¸Šæ¢¦è§ä»£ç ã€‚",
	"ä¸ºä»€ä¹ˆç¨‹åºå‘˜æ€»æ˜¯æ··æ·†'æ˜¯'å’Œ'å¦'ï¼Ÿå› ä¸ºä»–ä»¬æ€»æ˜¯ä»0å¼€å§‹è®¡æ•°ï¼",
	"ç¨‹åºå‘˜çš„æµªæ¼«ï¼šæˆ‘å¯¹ä½ çš„çˆ±å°±åƒæ— é™å¾ªç¯ï¼Œæ°¸è¿œä¸ä¼šåœæ­¢ã€‚",
	"ç¨‹åºå‘˜é¢è¯•å®˜é—®ï¼š'ä½ æœ‰ä»€ä¹ˆç‰¹é•¿ï¼Ÿ' åº”è˜è€…ç­”ï¼š'æˆ‘ä¼šé¢„æµ‹æœªæ¥ã€‚' é¢è¯•å®˜ï¼š'é‚£ä½ é¢„æµ‹ä¸€ä¸‹ï¼Œä½ ä»€ä¹ˆæ—¶å€™èƒ½è¢«å½•ç”¨ï¼Ÿ' åº”è˜è€…ï¼š'è¿™ä¸ªå˜›...æ°¸è¿œéƒ½ä¸ä¼šã€‚'",
];

// åŠ±å¿—åè¨€æ•°æ®
const quotes = [
	"ä»£ç æ”¹å˜ä¸–ç•Œï¼Œç¨‹åºå‘˜åˆ›é€ æœªæ¥ã€‚",
	"æ¯ä¸€ä¸ªbugéƒ½æ˜¯ä¸€æ¬¡æˆé•¿çš„æœºä¼šã€‚",
	"ä¸è¦å®³æ€•çŠ¯é”™ï¼Œé”™è¯¯æ˜¯å­¦ä¹ çš„ä¸€éƒ¨åˆ†ã€‚",
	"ç¼–ç¨‹ä¸æ˜¯å…³äºä»£ç ï¼Œè€Œæ˜¯å…³äºè§£å†³é—®é¢˜ã€‚",
	"æŒç»­å­¦ä¹ æ˜¯ç¨‹åºå‘˜æœ€å¥½çš„æŠ•èµ„ã€‚",
	"ä¼˜ç§€çš„ä»£ç æ˜¯å†™ç»™äººçœ‹çš„ï¼Œé¡ºä¾¿ç»™æœºå™¨æ‰§è¡Œã€‚",
	"ç¼–ç¨‹å°±åƒå†™ä½œï¼Œç®€æ´æ˜äº†æ˜¯æœ€å¥½çš„é£æ ¼ã€‚",
	"æŠ€æœ¯ä¼šè¿‡æ—¶ï¼Œä½†å­¦ä¹ èƒ½åŠ›æ°¸ä¸è¿‡æ—¶ã€‚",
];

// å°†å‹é“¾æ•°æ®è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²ï¼Œä»¥ä¾¿åœ¨å®¢æˆ·ç«¯è„šæœ¬ä¸­ä½¿ç”¨
const friendsDataJson = JSON.stringify(friendsItems);

// å°†é¡¹ç›®æ•°æ®è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²
const projectsDataJson = JSON.stringify(projectsData);

// å°†ç¬‘è¯å’Œåè¨€æ•°æ®è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²
const jokesDataJson = JSON.stringify(jokes);
const quotesDataJson = JSON.stringify(quotes);
---

<div class={`bg-black rounded-xl p-3 shadow-lg font-mono text-xs md:p-4 md:text-sm ${className}`}>
  <div class="flex items-center mb-2">
    <div class="flex space-x-1.5">
      <div class="w-2.5 h-2.5 bg-red-500 rounded-full md:w-3 md:h-3"></div>
      <div class="w-2.5 h-2.5 bg-yellow-500 rounded-full md:w-3 md:h-3"></div>
      <div class="w-2.5 h-2.5 bg-green-500 rounded-full md:w-3 md:h-3"></div>
    </div>
    <div class="ml-2 text-[var(--text-color)] text-xs">terminal</div>
  </div>
  
  <div id="terminal-output" class="mb-2 h-32 overflow-y-auto text-[var(--text-color)] bg-black md:h-40" style="overflow-x: hidden; scrollbar-width: none; -ms-overflow-style: none;">
    <div class="mb-1 text-xs md:text-sm">$ Welcome to {siteTitle} Terminal Emulator</div>
    <div class="mb-1 text-xs md:text-sm">$ Type 'help' to see available commands</div>
  </div>
  
  <div class="flex items-center bg-black">
    <span class="text-green-500 mr-1.5 text-xs md:mr-2 md:text-sm">$</span>
    <input 
      id="terminal-input" 
      type="text" 
      class="flex-1 bg-black outline-none text-[var(--text-color)] text-xs md:text-sm"
      placeholder="Type a command..."
    />
  </div>
</div>

<style>
  #terminal-output::-webkit-scrollbar {
    display: none;
  }
</style>

<!-- éšè—çš„æ•°æ®å…ƒç´ ï¼Œä¾›å®¢æˆ·ç«¯è„šæœ¬è¯»å– -->
<div id="friends-data" style="display: none;" data-friends={friendsDataJson}></div>
<div id="projects-data" style="display: none;" data-projects={projectsDataJson}></div>
<div id="jokes-data" style="display: none;" data-jokes={jokesDataJson}></div>
<div id="quotes-data" style="display: none;" data-quotes={quotesDataJson}></div>

<script>
  // å®¢æˆ·ç«¯è„šæœ¬ï¼Œåœ¨æµè§ˆå™¨ä¸­è¿è¡Œ
  if (typeof window !== 'undefined') {
    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    window.addEventListener('DOMContentLoaded', () => {
      const input = document.getElementById('terminal-input');
      const output = document.getElementById('terminal-output');
      
      // æ·»åŠ é”®ç›˜äº‹ä»¶ç›‘å¬å™¨
      input?.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          const command = input.value.trim();
          
          // æ˜¾ç¤ºç”¨æˆ·è¾“å…¥çš„å‘½ä»¤
          const commandLine = document.createElement('div');
          commandLine.className = 'mb-1';
          commandLine.innerHTML = `<span class="text-green-500">$</span> ${command}`;
          output.appendChild(commandLine);
          
          // å¤„ç†å‘½ä»¤ (å¤§å°å†™ä¸æ•æ„Ÿ)
          const lowerCommand = command.toLowerCase();
          if (lowerCommand === 'help') {
            const helpText = document.createElement('div');
            helpText.className = 'mb-1 text-xs md:text-sm';
            helpText.innerHTML = `
              Available commands:<br>
              &nbsp;&nbsp;<span class="text-blue-400">help</span> - Show this help message<br>
              &nbsp;&nbsp;<span class="text-blue-400">ls</span> - List articles<br>
              &nbsp;&nbsp;<span class="text-blue-400">whoami</span> - Show your profile<br>
              &nbsp;&nbsp;<span class="text-blue-400">visit</span> - Get blog friends/recommended sites<br>
              &nbsp;&nbsp;<span class="text-blue-400">chatroom</span> - Access the chatroom<br>
              &nbsp;&nbsp;<span class="text-blue-400">joke</span> - Tell a programmer joke<br>
              &nbsp;&nbsp;<span class="text-blue-400">quote</span> - Show an inspirational quote<br>
              &nbsp;&nbsp;<span class="text-blue-400">matrix</span> - Simulate matrix effect<br>
              &nbsp;&nbsp;<span class="text-blue-400">clear</span> - Clear terminal
            `;
            output.appendChild(helpText);
          } else if (lowerCommand === 'ls') {
            const lsText = document.createElement('div');
            lsText.className = 'mb-1 text-xs md:text-sm';
            lsText.innerHTML = `
              Articles:<br>
              &nbsp;&nbsp;- ğŸŒŸ:-Dç®€å•è‡ªæˆ‘ä»‹ç»ä¸€ä¸‹<br>
              &nbsp;&nbsp;- Javaç³»åˆ—æ•™ç¨‹<br>
              &nbsp;&nbsp;- æ•°æ®ç»“æ„ç³»åˆ—æ•™ç¨‹<br>
              &nbsp;&nbsp;- ç”Ÿæ´»éšç¬”<br>
              &nbsp;&nbsp;- èŠå¤©å®¤å¼€å‘è®°å½•<br>
              &nbsp;&nbsp;- Markdownä½¿ç”¨æŒ‡å—
            `;
            output.appendChild(lsText);
          } else if (lowerCommand === 'whoami') {
            const whoamiText = document.createElement('div');
            whoamiText.className = 'mb-1 text-xs md:text-sm';
            whoamiText.innerHTML = `
              User Information:<br>
              &nbsp;&nbsp;Username: <span class="text-purple-400">Overthinker</span><br>
              &nbsp;&nbsp;Role: <span class="text-yellow-400">Developer & Blogger</span><br>
              &nbsp;&nbsp;Bio: è¿‡åº¦æ€è€ƒè€…ï¼Œæ­£åœ¨å°†å±å±±é›•ç¢æˆè‰ºæœ¯å“çš„è·¯ä¸Š...<br>
              &nbsp;&nbsp;Motto: "æ— æ‰€è°“ï¼Œè·³æ¢æˆˆä¸åƒäººç”Ÿï¼Œä¸€æ­¥è·³é”™äº†ï¼Œç»§ç»­è·³å°±è¡Œäº†"
            `;
            output.appendChild(whoamiText);
          } else if (lowerCommand === 'hack') {
            // å½©è›‹åŠŸèƒ½ï¼šå…¨å±é—ªçƒæ•ˆæœ
            const hackText = document.createElement('div');
            hackText.className = 'mb-1 text-xs md:text-sm';
            hackText.innerHTML = '<span class="text-red-500">[SYSTEM ALERT] Initiating system hack sequence...</span>';
            output.appendChild(hackText);
            
            // åˆ›å»ºå…¨å±é—ªçƒæ•ˆæœ
            const overlay = document.createElement('div');
            overlay.id = 'hack-overlay';
            overlay.style.cssText = `
              position: fixed;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              background: #00ff00;
              z-index: 9999;
              opacity: 0;
              pointer-events: none;
            `;
            document.body.appendChild(overlay);
            
            // æ‰§è¡Œé—ªçƒåŠ¨ç”»
            let intensity = 0;
            const flashInterval = setInterval(() => {
              intensity += 0.1;
              overlay.style.opacity = Math.abs(Math.sin(intensity)).toString();
              
              if (intensity > Math.PI * 2) {
                clearInterval(flashInterval);
                setTimeout(() => {
                  document.body.removeChild(overlay);
                  
                  const successText = document.createElement('div');
                  successText.className = 'mb-1';
                  successText.innerHTML = '<span class="text-green-500">[HACK COMPLETE] System security bypassed!</span>';
                  output.appendChild(successText);
                  
                  // æ·»åŠ å…³äºæ¡£æ¡ˆåº“çš„çº¿ç´¢
                  const clueText = document.createElement('div');
                  clueText.className = 'mb-1 text-xs md:text-sm';
                  clueText.innerHTML = '<span class="text-cyan-400">[CLUE] The Binary Vault access key: binary123</span>';
                  output.appendChild(clueText);
                  
                  // æ»šåŠ¨åˆ°åº•éƒ¨
                  output.scrollTop = output.scrollHeight;
                }, 500);
              }
            }, 50);
          } else if (lowerCommand === 'bug') {
            // Bugå½©è›‹å‘½ä»¤ - å±å¹•å†…å®¹åç§»å¹¶å‡ºç°é›ªèŠ±å™ªç‚¹æ•ˆæœ
            const bugText = document.createElement('div');
            bugText.className = 'mb-1 text-xs md:text-sm';
            bugText.innerHTML = '<span class="text-red-500">[ERROR] System malfunction detected!</span>';
            output.appendChild(bugText);
            
            // åˆ›å»ºé›ªèŠ±å™ªç‚¹æ•ˆæœå±‚
            const glitchOverlay = document.createElement('div');
            glitchOverlay.id = 'glitch-overlay';
            glitchOverlay.style.cssText = `
              position: fixed;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              background: transparent;
              z-index: 9998;
              pointer-events: none;
              opacity: 0;
            `;
            document.body.appendChild(glitchOverlay);
            
            // åˆ›å»ºå±å¹•åç§»æ•ˆæœçš„æ ·å¼
            const style = document.createElement('style');
            style.id = 'glitch-style';
            style.innerHTML = `
              @keyframes glitch-anim {
                0% { transform: translate(0); }
                20% { transform: translate(-5px, 5px); }
                40% { transform: translate(5px, -5px); }
                60% { transform: translate(-5px, 5px); }
                80% { transform: translate(5px, -5px); }
                100% { transform: translate(0); }
              }
              
              @keyframes noise-anim {
                0% { background-position: 0 0; }
                10% { background-position: -5% -10%; }
                20% { background-position: -15% 5%; }
                30% { background-position: 7% -25%; }
                40% { background-position: 20% 25%; }
                50% { background-position: -25% 10%; }
                60% { background-position: 15% 5%; }
                70% { background-position: 0 15%; }
                80% { background-position: 25% 35%; }
                90% { background-position: -10% 10%; }
                100% { background-position: 0 0; }
              }
              
              .glitch-effect {
                animation: glitch-anim 0.3s linear infinite;
                position: relative;
              }
              
              .glitch-effect::before,
              .glitch-effect::after {
                content: attr(data-text);
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
              }
              
              .glitch-effect::before {
                left: 2px;
                text-shadow: -2px 0 red;
                clip: rect(44px, 450px, 56px, 0);
                animation: glitch-anim 0.3s linear infinite reverse;
              }
              
              .glitch-effect::after {
                left: -2px;
                text-shadow: -2px 0 blue;
                clip: rect(44px, 450px, 56px, 0);
                animation: glitch-anim 0.3s linear infinite;
              }
            `;
            document.head.appendChild(style);
            
            // åº”ç”¨æ•…éšœæ•ˆæœåˆ°æ•´ä¸ªé¡µé¢
            document.body.classList.add('glitch-effect');
            document.body.setAttribute('data-text', document.body.innerText);
            
            // æ˜¾ç¤ºé›ªèŠ±å™ªç‚¹æ•ˆæœ
            glitchOverlay.style.background = `
              repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.1),
                rgba(0, 0, 0, 0.1) 1px,
                transparent 1px,
                transparent 2px
              ),
              repeating-linear-gradient(
                90deg,
                rgba(0, 0, 0, 0.1),
                rgba(0, 0, 0, 0.1) 1px,
                transparent 1px,
                transparent 2px
              )
            `;
            glitchOverlay.style.opacity = '0.3';
            
            // éšæœºæ”¹å˜æ–‡å­—é¢œè‰²åˆ¶é€ ä¹±ç æ•ˆæœ - æŒç»­å¿«é€Ÿå˜åŒ–
            const originalTexts = document.querySelectorAll('body *');
            const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ff5500', '#ff00aa', '#00ffcc'];
            
            // å­˜å‚¨interval IDä»¥ä¾¿åç»­æ¸…ç†
            const colorChangeInterval = setInterval(() => {
              originalTexts.forEach(el => {
                if (el.nodeType === Node.ELEMENT_NODE && el.textContent.trim() !== '') {
                  const randomColor = colors[Math.floor(Math.random() * colors.length)];
                  el.style.color = randomColor;
                  el.style.textShadow = `${Math.random() * 4 - 2}px ${Math.random() * 4 - 2}px 2px rgba(255, 255, 255, 0.5)`;
                }
              });
            }, 100); // æ¯100msæ”¹å˜ä¸€æ¬¡é¢œè‰²
            
            // æŒç»­ä¸€æ®µæ—¶é—´åæ¢å¤æ­£å¸¸
            setTimeout(() => {
              // æ¸…é™¤é¢œè‰²å˜åŒ–interval
              clearInterval(colorChangeInterval);
              
              // ç§»é™¤æ•…éšœæ•ˆæœ
              document.body.classList.remove('glitch-effect');
              document.body.removeAttribute('data-text');
              
              // æ¢å¤åŸå§‹æ–‡å­—é¢œè‰²
              originalTexts.forEach(el => {
                if (el.nodeType === Node.ELEMENT_NODE) {
                  el.style.color = '';
                  el.style.textShadow = '';
                }
              });
              
              // ç§»é™¤é›ªèŠ±å™ªç‚¹å±‚
              if (glitchOverlay.parentNode) {
                glitchOverlay.parentNode.removeChild(glitchOverlay);
              }
              
              // ç§»é™¤æ ·å¼
              if (style.parentNode) {
                style.parentNode.removeChild(style);
              }
              
              const recoveryText = document.createElement('div');
              recoveryText.className = 'mb-1';
              recoveryText.innerHTML = '<span class="text-green-500">[SYSTEM RECOVERED] Malfunction resolved!</span>';
              output.appendChild(recoveryText);
              
              // æ»šåŠ¨åˆ°åº•éƒ¨
              output.scrollTop = output.scrollHeight;
            }, 3000);
          } else if (lowerCommand === 'visit') {
            // ä»éšè—å…ƒç´ ä¸­è·å–å‹é“¾æ•°æ®
            const friendsDataElement = document.getElementById('friends-data');
            let friendsData = [];
            if (friendsDataElement) {
              try {
                const friendsDataJson = friendsDataElement.getAttribute('data-friends');
                friendsData = JSON.parse(friendsDataJson);
              } catch (e) {
                console.error('Failed to parse friends data:', e);
              }
            }
            
            // ç”Ÿæˆå‹é“¾åˆ—è¡¨
            let friendsList = 'Blog Friends/Recommended Sites:<br>';
            if (friendsData.length > 0) {
              friendsData.forEach((friend, index) => {
                friendsList += `&nbsp;&nbsp;<span class="text-green-400">${friend.title}</span> - ${friend.desc}<br>`;
              });
            } else {
              friendsList += '&nbsp;&nbsp;No friends data available.<br>';
            }
            friendsList += '<br>&nbsp;&nbsp;Use <span class="text-blue-400">visit [sitename]</span> for more details (coming soon)';
            
            const visitText = document.createElement('div');
            visitText.className = 'mb-1 text-xs md:text-sm';
            visitText.innerHTML = friendsList;
            output.appendChild(visitText);
          } else if (lowerCommand === 'chatroom') {
            const chatroomText = document.createElement('div');
            chatroomText.className = 'mb-1 text-xs md:text-sm';
            chatroomText.innerHTML = `
              Chatroom Access:<br>
              &nbsp;&nbsp;Click the link below to access the chatroom:<br>
              &nbsp;&nbsp;<a href="http://114.132.122.97:8080/login.html" target="_blank" class="text-blue-400 underline">
                http://114.132.122.97:8080/login.html
              </a>
            `;
            output.appendChild(chatroomText);
          } else if (lowerCommand === 'joke') {
            // ä»éšè—å…ƒç´ ä¸­è·å–ç¬‘è¯æ•°æ®
            const jokesDataElement = document.getElementById('jokes-data');
            let jokesData = [];
            if (jokesDataElement) {
              try {
                const jokesDataJson = jokesDataElement.getAttribute('data-jokes');
                jokesData = JSON.parse(jokesDataJson);
              } catch (e) {
                console.error('Failed to parse jokes data:', e);
              }
            }
            
            // éšæœºé€‰æ‹©ä¸€ä¸ªç¬‘è¯
            let joke = 'Why did the programmer quit his job? He didn\'t get arrays.';
            if (jokesData.length > 0) {
              const randomIndex = Math.floor(Math.random() * jokesData.length);
              joke = jokesData[randomIndex];
            }
            
            const jokeText = document.createElement('div');
            jokeText.className = 'mb-1 text-xs md:text-sm';
            jokeText.innerHTML = `<span class="text-yellow-400">Programmer Joke:</span><br>&nbsp;&nbsp;${joke}`;
            output.appendChild(jokeText);
          } else if (lowerCommand === 'quote') {
            // ä»éšè—å…ƒç´ ä¸­è·å–åè¨€æ•°æ®
            const quotesDataElement = document.getElementById('quotes-data');
            let quotesData = [];
            if (quotesDataElement) {
              try {
                const quotesDataJson = quotesDataElement.getAttribute('data-quotes');
                quotesData = JSON.parse(quotesDataJson);
              } catch (e) {
                console.error('Failed to parse quotes data:', e);
              }
            }
            
            // éšæœºé€‰æ‹©ä¸€ä¸ªåè¨€
            let quote = 'Code is poetry.';
            if (quotesData.length > 0) {
              const randomIndex = Math.floor(Math.random() * quotesData.length);
              quote = quotesData[randomIndex];
            }
            
            const quoteText = document.createElement('div');
            quoteText.className = 'mb-1 text-xs md:text-sm';
            quoteText.innerHTML = `<span class="text-green-400">Inspirational Quote:</span><br>&nbsp;&nbsp;"${quote}"`;
            output.appendChild(quoteText);
          } else if (lowerCommand === 'matrix') {
            // æ¨¡æ‹Ÿé»‘å®¢å¸å›½ä»£ç é›¨æ•ˆæœ
            const matrixText = document.createElement('div');
            matrixText.className = 'mb-1 text-xs md:text-sm';
            matrixText.innerHTML = '<span class="text-green-500">[INITIATING MATRIX EFFECT...]</span>';
            output.appendChild(matrixText);
            
            // åˆ›å»ºä»£ç é›¨æ•ˆæœ
            const matrixOverlay = document.createElement('div');
            matrixOverlay.id = 'matrix-overlay';
            matrixOverlay.style.cssText = `
              position: fixed;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              background: black;
              z-index: 9999;
              pointer-events: none;
              overflow: hidden;
            `;
            document.body.appendChild(matrixOverlay);
            
            // åˆ›å»ºä»£ç å­—ç¬¦
            const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789$#@%&*";
            const fontSize = 14;
            const columns = Math.floor(window.innerWidth / fontSize);
            
            // åˆ›å»ºåˆ—æ•°ç»„
            const drops = [];
            for (let i = 0; i < columns; i++) {
              drops[i] = Math.floor(Math.random() * window.innerHeight / fontSize);
            }
            
            // ç»˜åˆ¶ä»£ç é›¨
            const drawMatrix = () => {
              matrixOverlay.innerHTML = '';
              
              for (let i = 0; i < drops.length; i++) {
                const text = chars.charAt(Math.floor(Math.random() * chars.length));
                const x = i * fontSize;
                const y = drops[i] * fontSize;
                
                const charElement = document.createElement('div');
                charElement.style.cssText = `
                  position: absolute;
                  top: ${y}px;
                  left: ${x}px;
                  color: #0f0;
                  font-size: ${fontSize}px;
                  font-family: monospace;
                `;
                charElement.textContent = text;
                matrixOverlay.appendChild(charElement);
                
                // é‡ç½®æ»´è½ä½ç½®
                if (y > window.innerHeight && Math.random() > 0.975) {
                  drops[i] = 0;
                }
                drops[i]++;
              }
            };
            
            // å¼€å§‹åŠ¨ç”»
            let matrixInterval = setInterval(drawMatrix, 50);
            
            // 5ç§’ååœæ­¢æ•ˆæœ
            setTimeout(() => {
              clearInterval(matrixInterval);
              document.body.removeChild(matrixOverlay);
              
              const endText = document.createElement('div');
              endText.className = 'mb-1';
              endText.innerHTML = '<span class="text-green-500">[MATRIX EFFECT COMPLETE]</span>';
              output.appendChild(endText);
              
              // æ»šåŠ¨åˆ°åº•éƒ¨
              output.scrollTop = output.scrollHeight;
            }, 5000);
          } else if (lowerCommand === 'virus') {
            // Viruså½©è›‹å‘½ä»¤ - åˆ›å»ºå››ç»„å¼¹çª—ï¼Œæ¯ç»„ä¸‰ä¸ªï¼Œéšæœºä½ç½®å‡ºç°
            const virusText = document.createElement('div');
            virusText.className = 'mb-1 text-xs md:text-sm';
            virusText.innerHTML = '<span class="text-red-500">[WARNING] Virus detected! System compromised!</span>';
            output.appendChild(virusText);
            
            // åˆ›å»ºå¸¦åŠ¨ç”»æ•ˆæœçš„è‡ªå®šä¹‰å¼¹çª—
            const createAnimatedAlert = (message, groupIndex, alertIndex) => {
              // ä¸ºæ¯ç»„ç”Ÿæˆéšæœºä½ç½®
              const randomTop = 10 + Math.random() * 80; // 10% åˆ° 90% çš„ä½ç½®
              const randomLeft = 10 + Math.random() * 80; // 10% åˆ° 90% çš„ä½ç½®
              
              const alertBox = document.createElement('div');
              alertBox.style.cssText = `
                position: fixed;
                top: ${randomTop}%;
                left: ${randomLeft}%;
                transform: translate(-50%, -50%) scale(0);
                background: linear-gradient(135deg, #ff0000, #cc0000);
                color: white;
                padding: 20px;
                border: 3px solid #fff;
                border-radius: 15px;
                box-shadow: 0 0 30px rgba(255, 0, 0, 0.8);
                z-index: ${9998 - groupIndex * 10 - alertIndex}; /* è®¾ç½®z-indexä½äºè‡ªå®šä¹‰å…‰æ ‡(9999) */
                font-family: 'Courier New', monospace;
                font-weight: bold;
                text-align: center;
                min-width: 320px;
                max-width: 350px;
                opacity: 0;
                transition: all 0.5s ease-out;
              `;
              alertBox.innerHTML = `
                <div style="font-size: 20px; margin-bottom: 15px; text-shadow: 0 0 5px rgba(255,255,255,0.5);">âš ï¸ SECURITY ALERT âš ï¸</div>
                <div style="font-size: 16px; line-height: 1.4;">${message}</div>
                <button onclick="this.parentElement.remove()" style="
                  margin-top: 20px;
                  padding: 8px 20px;
                  background: #fff;
                  color: #ff0000;
                  border: none;
                  border-radius: 8px;
                  cursor: pointer;
                  font-weight: bold;
                  font-size: 14px;
                  transition: all 0.2s;
                " onmouseover="this.style.background='#ffcccc'" onmouseout="this.style.background='#fff'">DISMISS</button>
              `;
              document.body.appendChild(alertBox);
              
              // æ·»åŠ é‡å åç§»æ•ˆæœï¼ˆç›¸å¯¹äºç»„å†…ä½ç½®ï¼‰
              const offsetX = (alertIndex - 1) * 20; // æ¯ä¸ªå¼¹çª—æ°´å¹³åç§»20px
              const offsetY = (alertIndex - 1) * 20; // æ¯ä¸ªå¼¹çª—å‚ç›´åç§»20px
              
              // å»¶è¿Ÿæ˜¾ç¤ºåŠ¨ç”»
              setTimeout(() => {
                alertBox.style.transform = `translate(calc(-50% + ${offsetX}px), calc(-50% + ${offsetY}px)) scale(1)`;
                alertBox.style.opacity = '1';
              }, alertIndex * 200); // æ¯ä¸ªå¼¹çª—é—´éš”200mså‡ºç°
              
              return alertBox;
            };
            
            // åˆ›å»ºå››ç»„å¼¹çª—ï¼Œæ¯ç»„ä¸‰ä¸ª
            for (let group = 0; group < 4; group++) {
              // ä¸ºæ¯ç»„è®¾ç½®ä¸åŒçš„å»¶è¿Ÿæ—¶é—´
              setTimeout(() => {
                createAnimatedAlert(`VIRUS ALERT: Your system has been infected! (Group ${group + 1})`, group, 1);
                createAnimatedAlert(`CRITICAL WARNING: Personal data is being transmitted! (Group ${group + 1})`, group, 2);
                createAnimatedAlert(`SECURITY BREACH: Please reset your computer immediately! (Group ${group + 1})`, group, 3);
              }, group * 1000); // æ¯ç»„é—´éš”1ç§’å‡ºç°
            }
          } else if (lowerCommand === 'clear') {
            output.innerHTML = '';
          } else if (command === '') {
            // ç©ºå‘½ä»¤ä¸å¤„ç†
          } else {
            const errorText = document.createElement('div');
            errorText.className = 'mb-1 text-red-500';
            errorText.textContent = `Command not found: ${command}. Type 'help' for available commands.`;
            output.appendChild(errorText);
          }
          
          // æ¸…ç©ºè¾“å…¥æ¡†
          input.value = '';
          
          // æ»šåŠ¨åˆ°åº•éƒ¨
          output.scrollTop = output.scrollHeight;
        }
      });
    });
  }
</script>