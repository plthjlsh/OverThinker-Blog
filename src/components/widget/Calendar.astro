---
interface Props {
	class?: string;
}

const { class: className = "" } = Astro.props;

// 获取当前日期
const today = new Date();
const currentYear = today.getFullYear();
const currentMonth = today.getMonth();
const currentDate = today.getDate();

// 月份名称
const monthNames = [
	"January",
	"February",
	"March",
	"April",
	"May",
	"June",
	"July",
	"August",
	"September",
	"October",
	"November",
	"December",
];

// 星期名称
const dayNames = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];

// 生成日历数据
function generateCalendar(year: number, month: number) {
	const firstDay = new Date(year, month, 1).getDay();
	const daysInMonth = new Date(year, month + 1, 0).getDate();
	const daysInPrevMonth = new Date(year, month, 0).getDate();

	const calendarDays = [];

	// 上个月的日期
	for (let i = firstDay - 1; i >= 0; i--) {
		calendarDays.push({
			day: daysInPrevMonth - i,
			isCurrentMonth: false,
			isToday: false,
		});
	}

	// 当前月的日期
	for (let i = 1; i <= daysInMonth; i++) {
		const isToday =
			year === currentYear && month === currentMonth && i === currentDate;
		calendarDays.push({
			day: i,
			isCurrentMonth: true,
			isToday: isToday,
		});
	}

	// 下个月的日期（补齐到42天）
	const remainingDays = 42 - calendarDays.length;
	for (let i = 1; i <= remainingDays; i++) {
		calendarDays.push({
			day: i,
			isCurrentMonth: false,
			isToday: false,
		});
	}

	return calendarDays;
}

const calendarDays = generateCalendar(currentYear, currentMonth);
---

<div class={`bg-[var(--card-bg)] rounded-xl p-4 shadow-lg ${className}`}>
  <div class="mb-4">
    <h2 class="text-xl font-bold text-center text-[var(--text-color)]">
      {monthNames[currentMonth]} {currentYear}
    </h2>
  </div>
  
  <!-- 星期标题 -->
  <div class="grid grid-cols-7 gap-1 mb-2">
    {dayNames.map((day) => (
      <div class="text-center text-sm font-medium py-2" style="color: var(--text-color); opacity: 0.8;">
        {day}
      </div>
    ))}
  </div>
  
  <!-- 日历日期 -->
  <div class="grid grid-cols-7 gap-1">
    {calendarDays.map((date) => (
      <div 
        class={`h-8 flex items-center justify-center text-sm rounded-lg transition-all duration-200
          ${date.isToday 
            ? 'bg-green-500 text-white font-bold' 
            : date.isCurrentMonth 
              ? 'hover:bg-green-500 hover:bg-opacity-20' 
              : 'opacity-50'}
        `}
        style={!date.isToday ? "color: var(--text-color);" : ""}
      >
        {date.day}
      </div>
    ))}
  </div>
</div>

